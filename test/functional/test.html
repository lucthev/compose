<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Compose Tests</title>
  <script>
    /* jshint ignore:start */
    !function(n){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=n();else if("function"==typeof define&&define.amd)define([],n);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self);e.QueryString=n()}}(function(){return function e(k,g,m){function f(a,c){if(!g[a]){if(!k[a]){var b="function"==typeof require&&require;if(!c&&b)return b(a,!0);if(h)return h(a,!0);b=Error("Cannot find module '"+a+"'");throw b.code="MODULE_NOT_FOUND",b;}b=g[a]={exports:{}};k[a][0].call(b.exports,function(b){var c=k[a][1][b];return f(c?c:b)},b,b.exports,e,k,g,m)}return g[a].exports}for(var h="function"==typeof require&&require,p=0;p<m.length;p++)f(m[p]);return f}({1:[function(e,k,g){k.exports=e("querystring")},{querystring:4}],2:[function(e,k,g){k.exports=function(f,h,e,a){e=e||"=";var c={};if("string"!==typeof f||0===f.length)return c;var b=/\+/g;f=f.split(h||"&");h=1E3;a&&"number"===typeof a.maxKeys&&(h=a.maxKeys);a=f.length;0<h&&a>h&&(a=h);for(h=0;h<a;++h){var d=f[h].replace(b,"%20"),g=d.indexOf(e),l;0<=g?(l=d.substr(0,g),d=d.substr(g+1)):(l=d,d="");l=decodeURIComponent(l);d=decodeURIComponent(d);Object.prototype.hasOwnProperty.call(c,l)?m(c[l])?c[l].push(d):c[l]=[c[l],d]:c[l]=d}return c};var m=Array.isArray||function(f){return"[object Array]"===Object.prototype.toString.call(f)}},{}],3:[function(e,k,g){function m(a,c){if(a.map)return a.map(c);for(var b=[],d=0;d<a.length;d++)b.push(c(a[d],d));return b}var f=function(a){switch(typeof a){case "string":return a;case "boolean":return a?"true":"false";case "number":return isFinite(a)?a:"";default:return""}};k.exports=function(a,c,b,d){c=c||"&";b=b||"=";null===a&&(a=void 0);return"object"===typeof a?m(p(a),function(d){var e=encodeURIComponent(f(d))+b;return h(a[d])?m(a[d],function(a){return e+encodeURIComponent(f(a))}).join(c):e+encodeURIComponent(f(a[d]))}).join(c):d?encodeURIComponent(f(d))+b+encodeURIComponent(f(a)):""};var h=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},p=Object.keys||function(a){var c=[],b;for(b in a)Object.prototype.hasOwnProperty.call(a,b)&&c.push(b);return c}},{}],4:[function(e,k,g){g.decode=g.parse=e("./decode");g.encode=g.stringify=e("./encode")},{"./decode":2,"./encode":3}]},{},[1])(1)});
  </script>
  <style>
    hr {
      height: 0;
      width: 260px;
      margin: 22px auto;
      padding: 0;
      border: none;
      visibility: hidden;
    }

    hr:before {
      content: '';
      width: 260px;
      height: 1px;
      background: #aaa;
      display: block;
      visibility: visible;
      margin: 22px auto;
    }

    #editor {
      width: 100%;
      height: 100%;
      outline: none;
      font-family: Roboto, Helvetica, Arial, sans-serif;
      font-size: 20px;
    }

    #editor section {
      width: 720px;
      margin: 0 auto;
    }

    .section-first {
      margin-top: 22px;
    }

    .section-last {
      margin-bottom: 22px;
    }

    .section-first hr {
      display: none;
    }

    pre, code {
      font-family: Monaco;
    }
  </style>
</head>
<body>
  <article id="editor"></article>
  <script src="../../dist/compose.min.js"></script>
  <script>
    var editor = document.querySelector('#editor'),
        query = window.location.search.substr(1)

    query = QueryString.parse(query)
    editor.innerHTML = query.html || ''
    window.editor = new Compose(editor)
  </script>
  <script>
  var blocks = ['p', 'h1', 'h2', 'h3', 'pre', 'blockquote', 'li']

  function getChildren (elem) {
    return Array.prototype.map.call(elem.childNodes, function (node) {
      return makeTree(node)
    })
  }

  function makeTree (elem) {
    var name = elem.nodeName.toLowerCase(),
        children

    if (blocks.indexOf(name) > -1) return {
      name: name,
      html: elem.innerHTML
    }

    if (name === 'hr') return { name: name }

    children = Array.prototype.slice.call(elem.childNodes)
    return {
      name: name,
      children: children.map(function (child) {
        return makeTree(child)
      })
    }
  }
  </script>
</body>
</html>
